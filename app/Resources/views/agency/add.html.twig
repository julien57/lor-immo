{% extends 'agency_layout.html.twig' %}

{% block body %}

    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header bg-light">
                        Ajouter un bien
                    </div>

                    <div class="card-body">

                        {{ form_start(form) }}

                        <div class="row">
                            <div class="col-md-3">
                                {{ form_row(form.title) }}

                                {{ form_row(form.room) }}

                                {{ form_row(form.bedroom) }}
                            </div>
                            <div class="col-md-9">
                                {{ form_row(form.description) }}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                {{ form_row(form.area, {'attr': {'placeholder': '0 si nul'}}) }}
                            </div>
                            <div class="col-md-3">
                                {{ form_row(form.garden, {'attr': {'placeholder': '0 si nul'}}) }}
                            </div>
                            <div class="col-md-3">
                                {{ form_row(form.heater) }}
                            </div>
                            <div class="col-md-3">
                                {{ form_row(form.garage) }}
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-3">
                                {{ form_row(form.type) }}
                            </div>
                            <div class="col-md-3">
                                {{ form_row(form.department) }}
                            </div>
                            <div class="col-md-3">
                                {{ form_row(form.city) }}
                            </div>
                            <div class="col-md-3">
                                {{ form_row(form.price) }}
                            </div>
                        </div>
                        <div class="row">
                            <ul class="photo list-group" data-prototype="{{ form_widget(form.photo.vars.prototype)|e('html_attr') }}">

                            </ul>
                        </div>
                        <div class="form-group mt-5">
                            <div class="col-md-12">
                                <div class="float-left">
                                    <a href="{{ path('agency_home_dashboard') }}" class="btn-lg btn-secondary">
                                        <i class="fa fa-align-center"></i> Retour
                                    </a>
                                </div>
                                <div class="float-right">
                                    <button type="submit" class="btn-lg btn-info">
                                        <i class="fa fa-download"></i> Ajouter
                                    </button>
                                </div>
                            </div>
                        </div>

                        {{ form_end(form) }}

                    </div>
                </div>
            </div>
        </div>
    </div>

{% endblock %}

{% block javascript %}
    var $collectionHolder;

const $addPhotoButton = $('<button type="button" class="btn btn-primary add_property_photo">Ajouter une photo</button>');
const $newLinkLi = $('<li class="list-group-item"></li>').append($addPhotoButton);

jQuery(document).ready(function () {

    $collectionHolder = $('ul.photo');
    $collectionHolder.append($newLinkLi);

    $collectionHolder.data('index', $collectionHolder.find(':input').length);

    $addPhotoButton.click(function (e) {

        addPhotoForm($collectionHolder, $newLinkLi);
    });

    function addPhotoForm($collectionHolder, $newLinkLi) {

        const prototype = $collectionHolder.data('prototype');

        const index = $collectionHolder.data('index');

        let newForm = prototype;

        newForm = newForm.replace(/__name__/g, index);

        $collectionHolder.data('index', index + 1);

        const $newFormLi = $('<li class="list-group-item"></li>').append(newForm);
        $newLinkLi.before($newFormLi);
    }
})

{% endblock %}